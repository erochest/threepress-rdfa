{% extends "base.html" %}

{% block title %}{{ request.user.username }}'s profile{% endblock %}

{% block searcharea %}{% endblock %}

{% block head %}
<link rel="stylesheet" type="text/css" href="/static/home.css" ></link>
<style type="text/css">
 ol { list-style-type: none; padding:0; margin:0; color: gray; }
 li a { text-decoration: none; color:gray;}
form fieldset {
  border: 1px solid rgb(200,200,200);
  background-color: rgb(248, 255, 239);
  -moz-border-radius: 0; 
  -webkit-border-radius: 0; 
}
form input {
 -moz-border-radius: 0;
 padding:0;margin:0;
}
</style>
{% endblock head %}

{% block leftnav %}
<ol>
{% if not request.openid %}
<li><h3><a href="{% url django_authopenid.views.changepw %}">Change password</a></h3></li>
{% endif %}

{% if not request.openid %}
<li><h3><a href="{% url django_authopenid.views.changeemail %}">Change email address</a></h3></li>
{% endif %}
{% if request.openid %}
<li><h3><a href="{% url django_authopenid.views.changeopenid %}">Change associated OpenID</a></h3></li>
{% endif %}
<li><h3><a href="{% url django_authopenid.views.delete %}">Delete this account</a></h3></li>
</ol>

{% if request.openid %}
<p>Some fields such as email and country have been imported via OpenID
and should be changed with your OpenID provider, rather than with Bookworm.</p>
{% endif %}


{% endblock %}

{% block main %}

<div id="bw-content">

{% if message or request.GET.msg or form.errors %}
<p class="bw-message"><strong>{{ message }} {{ form.errors }}</strong></p>
{% endif %}


<h1>User profile settings for {{ request.user.username }}</h1>

<form action="{% url profile %}" method="post">

  <table class="bw-meta">
    <thead>
      <tr>
        <th class="bw-table_header" colspan="2">User information</th>
      </tr>
    </thead>     
    <tbody>
      <tr>
        <th>Username</th>
        <td>{{ request.user.username }}</td>
      </tr>
      {% if request.openid %}
      <tr>
        <th>OpenID</th>
        <td>
          {% if request.session.openids %}
            {% for url in request.session.openids %} 
              {{ url }}
            {% endfor %}
          {% else %}
            {{ request.openid }}
          {% endif %}
          
      <a href="{% url django_authopenid.views.changeopenid %}">[change]</a></td>
    </tr>
    {% endif %}
    <tr>
      <th>Full name</th>
      <td>{{ form.fullname }}</td>
    </tr>

    <tr>
      <th>Email address</th>
      <td> {{ request.user.email }} {% if not request.openid %}<a href="{% url django_authopenid.views.changeemail %}">[change]</a>{% endif %} </td>
    </tr>
    {% if prefs.country %}
    <tr>
      <th>Country</th>
      <td> {{ prefs.country }}</td>
    </tr>
    {% endif %}
    {% if prefs.language %}
    <tr>
      <th>Language</th>
      <td> {{ current_search_language }} [<a href="{% url profile_language %}">change</a>]</td>
    </tr>
    {% endif %}

    <tr>
      <th>Open to last-read chapter when reading a book?</th>
      <td> {{ form.open_to_last_chapter }}</td>
    </tr>
  </tbody>
</table>

<input type="submit" value="Update profile" />

</form>
</div>

{% endblock main %}
