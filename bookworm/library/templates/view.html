{% extends "base.html" %} 
{% spaceless %}
{% block title %}
  {% if chapter.title %}
     '{{ chapter.title }}' in 
  {% endif %}

  {{ document.title }}
  {% if document.author %} 
     by {{ document.author }} 
  {% endif %}
{% endblock title %}
{% endspaceless %}


{% block localstyles %}
{% spaceless %}
    {% if not request.common.prefs.use_iframe %}
      {% for css in stylesheets %}
      <link rel="stylesheet" href="{% url library.views.view_stylesheet document.safe_title,document.key,css.filename %}" />
      {% endfor %}
    {% endif %}
{% endspaceless %}
{% endblock %}

{% block head %}

<link rel="stylesheet" href="/static/document.css"></link>

{% include "includes/meta.html" %}

{% endblock head %}

{% block header %}
<a href="{% url view_first document.safe_title,document.key,"first" %}"><span class="bw-title">{{ document.title }}</span></a> 
{% endblock header %}

{% block leftnav %}

  {% include "includes/leftnav.html" %}

{% endblock leftnav %}

{% block main %}

<div id="bw-content">

{% if chapter %}


   <div id="bw-results_nav_top">{% include "includes/chapter_next_previous.html" %}</div>
  
      <div id="bw-book-content" >{{ chapter.render|safe }}</div>
  
   <div id="bw-results_nav_bottom">{% include "includes/chapter_next_previous.html" %}</div>

{% else %}

 <!-- Title page -->

   <h1 class="bw-book_title">{{ document.title }}</h1>
   <h2 class="bw-book_author">{% for a in document.authors.all %}{{ a }}{% if not forloop.last %}, {% endif %}{% endfor %}</h2>

   <p>
     To read this book online, select any of the sections to the left.
   </p>

   <table class="bw-meta">
     <thead>
       <tr>
         <th class="bw-table_header" colspan="2">Book information</th>
       </tr>
     </thead>     
     <tbody>
       {% if document.get_publisher %}
       <tr>
         <th>Publisher</th>
         <td>{{ document.get_publisher }}</td>
       </tr>
       {% endif %}

       {% if document.get_language %}
       <tr>
         <th>Language</th>
         <td>{{ document.get_language }}</td>
       </tr>
       {% endif %}

       <tr>
         <th>Date added to library</th>
         <td>{{ document.created_time|date:"l, F Y" }}</td>
       </tr>
       <!--
       <tr>
         <th>Number of sections</th>
         <td>{{ toc|length }}</td>
       </tr>
       -->
       {% if document.get_subjects %}
       <tr>
         <th>Subjects</th>
         <td>{% for s in document.get_subjects %}{{ s }}{% if not forloop.last %}, {% endif %}{% endfor %}</td>
       </tr>
       {% endif %}

       {% if document.get_rights %}
       <tr>
         <th>Rights</th>
         <td>{{ document.get_rights }}</td>
       </tr>
       {% endif %}


       <tr>
         <th>Download entire book</th>
         <td><a href="{% url library.views.download_epub document.safe_title,document.key %}">epub format</a></td>
       </tr>
       {% if document.has_stylesheets %}
       <tr>
         <th>Read this book with its own styles and fonts?</th>
         <td>
           {% if request.common.prefs.use_iframe %}
           Yes, show book's styles in a scrolling window 
           <br/>(<a href="{% url library.views.view_chapter document.safe_title,document.key,chapter.filename %}?iframe=no">change this</a>)
           {% else %}
           No, view without styles 
           <br/>(<a href="{% url library.views.view_chapter document.safe_title,document.key,chapter.filename %}?iframe=yes">change this)</a>
           {% endif %}
         </td>
       </tr>
       {% endif %}

     </tbody>
   </table>
         
{% endif %}

</div>

{% endblock main %}
