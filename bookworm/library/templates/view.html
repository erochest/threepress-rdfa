{% extends "base.html" %} 

{% block leftnav %}

<ol class="nav">
{% for chapter in toc %}
  <li><a href="{% url library.views.view_chapter document.safe_title,document.safe_author,chapter.idref %}">{{ chapter.title }}</a></li>
{% endfor %}
</ol>

{% endblock leftnav %}

{% block main %}
<h1>{{document.title }}</h1>
<h2>{{document.author}}</h2>

<div id="content" style="height:100%">
{% if chapter %}
  {% if use_iframe %}
  <div style="width:100%">
   <iframe style="padding-bottom: 2em; margin-bottom:2em; border-bottom:1px dotted grey" id="frame" frameborder="0" marginheight="20" marginwidth="0" align="left" width="100%" name="content" src="{% url library.views.view_chapter_frame document.safe_title,document.safe_author,chapter.idref %}">
     <p>Your browser doesn't support iframes, but that's okay: <a href="{% url library.views.view_chapter document.safe_title,document.safe_author,chapter.idref %}?iframe=no">disable iframes</a></p>
   </iframe>
   <script type="text/javascript">
     function resizeIframe() {
     var height = document.documentElement.clientHeight;
     height -= document.getElementById('frame').offsetTop;
     
     // not sure how to get this dynamically
     height -= 50; /* whatever you set your body bottom margin/padding to be */
     
     document.getElementById('frame').style.height = height +"px";
     
     };
     document.getElementById('frame').onload = resizeIframe;
     window.onresize = resizeIframe;
   </script>
    
   <p>
     To disable the book's custom stylesheets and display only using the styles in Bookworm, you can
   <a href="{% url library.views.view_chapter document.safe_title,document.safe_author,chapter.idref %}?iframe=no">disable iframes</a>.</p>
  </div>
 {% else %}
   {% if document.has_stylesheets %}
   <p>
     Note: This ebook came bundled with its own stylesheets.  To use them you will need to <a href="{% url library.views.view_chapter document.safe_title,document.safe_author,chapter.idref %}?iframe=yes">enable iframes</a>.</p>
   </p>
   {% endif %}

   {{ chapter.render|safe }}
 {% endif %}
</div>


{% endif %}

{% endblock main %}
